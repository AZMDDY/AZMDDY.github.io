---
sort: 2
---

# this指针

C++的设计准则之一就是：**非静态成员函数至少必须和一般的非成员函数有相同的效率**。

也就是说，使用成员函数不会带来额外的负担。

编译器内部已经将**成员函数实例**转化成了对等的**非成员函数实例**。这个过程就涉及到了**this指针**。

这个转化步骤：

1. 改变函数签名，增加一个额外的形参，用于提供一个存取的管道，使得类的对象能够调用此函数，这个额外的形参就是**this指针**。这里不得不提到一点，成员函数被放置到类对象空间之外，只有一份，那么不同对象调用成员函数就是利用了这个**this指针**：

```cpp
void Person::SetAge(int age);
// 将成员函数实例转化成了对等的非成员函数实例，如下:
void Person::SetAge(Person* const this, int age);
```

2. 对每个**非静态成员函数**的存取操作都是通过this指针来完成的。
3. 编译器对函数进行符号修饰，使得这个函数名称独一无二。

```shell
// 通过nm工具查看符号表
_ZN6Person6SetAgeEi
```

```cpp
obj.SetAge(5);
```

转换成：

```cpp
_ZN6Person6SetAgeEi(&obj, 5);
```

通过上述过程，应该能够清楚的明白**this指针**的作用以及意义所在。

对于以下结论会有一个更清晰的认识：

+ this指针不是对象的一部分，不影响sizeof()的结果；
+ this指针只能在非静态成员函数中使用；
+ this指针的声明周期在成员函数开始到结束；
